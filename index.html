<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Tyler Buchanan - Portfolio</title>
    <script>
        (function () {
            const params = new URLSearchParams(window.location.search);
            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            if (!isMobile && !params.has('mobile') && !params.has('force_mobile')) {
                window.location.replace('index_v2.html');
            }
        })();
    </script>
    <link rel="icon" type="image/png" sizes="32x32" href="MeMoji-Favicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="MeMoji-Favicon.png">
    <link rel="apple-touch-icon" href="MeMoji-Favicon.png">
    <link rel="stylesheet" href="styles.css?v=132">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Theme toggle - transitions exactly like name-section */
        .theme-toggle {
            position: fixed !important;
            top: 3rem;
            right: 4rem;
            z-index: 10001 !important;
            pointer-events: auto !important;
        }
        
        /* Ensure theme toggle icons container never fades - only allow icon swap transitions */
        .theme-toggle .sun-icon,
        .theme-toggle .moon-icon {
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
        }

        /* Disable image opacity transitions during theme swap */
        .theme-instant .carousel-image,
        .theme-instant .project-image {
            transition: none !important;
        }

        /* Temporary window size readout */
        #size-readout {
            position: fixed;
            bottom: 12px;
            right: 12px;
            padding: 6px 10px;
            background: rgba(0, 0, 0, 0.65);
            color: #fff;
            font: 12px/1.2 -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            border-radius: 6px;
            z-index: 10002;
            pointer-events: none;
            letter-spacing: 0.02em;
        }
        
        
        /* Page Transition Styles */
        .page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            z-index: 1;
            transform: scale(0.95);
            background-color: var(--bg-color);
            transition: opacity 0.25s ease, visibility 0.25s ease, transform 0.25s ease, background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Theme toggle icons - allow icon swap transitions */
        .theme-toggle .sun-icon,
        .theme-toggle .moon-icon {
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
        }
        
        /* Home page enters from smaller scale */
        .home-page {
            transform-origin: center center;
        }
        
        .home-page.active {
            opacity: 1;
            visibility: visible;
            z-index: 2;
            transform: scale(1);
        }
        
        /* About page enters from above with larger scale */
        #about-page {
            transform-origin: center top;
            transform: translateY(-30px) scale(1.1);
            background-color: var(--about-glass-bg);
            backdrop-filter: blur(14px) saturate(120%);
            -webkit-backdrop-filter: blur(14px) saturate(120%);
            transition: transform 0.25s ease, opacity 0.25s ease, background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        #about-page.active {
            opacity: 1;
            visibility: visible;
            z-index: 2;
            transform: translateY(0) scale(1);
            transition: transform 0.25s ease, opacity 0.25s ease, background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* About page exits - lifts up (reverse of entry) */
        #about-page.exiting {
            opacity: 0;
            transform: translateY(-30px) scale(1.1);
        }
        
        /* Home page exits - shrinks (only for About page transitions) */
        .home-page.exiting:not(.exiting-to-project) {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 0.25s ease, transform 0.25s ease;
        }
        
        /* Home page exits differently for project page (no fade) */
        .home-page.exiting.exiting-to-project {
            opacity: 1;
            transition: opacity 0.3s ease 1.5s;
        }
        
        /* Home page enters from below when coming from About (reverse of About entry) */
        .home-page.entering-from-about {
            transform-origin: center center;
            opacity: 0;
            transform: translateY(30px) scale(0.9);
        }
        
        .home-page.entering-from-about.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            transition: opacity 0.25s ease, transform 0.25s ease;
        }
        
        /* Home page enters normally when coming from project page */
        .home-page:not(.entering-from-about).active {
            opacity: 1;
            visibility: visible;
            z-index: 2;
            transform: scale(1);
        }
        
        /* Keep carousel visible during transition - no fade, no blink */
        .home-page.exiting .timeline-carousel {
            opacity: 1 !important;
            z-index: 1000;
            pointer-events: none;
        }
        
        /* Carousel always visible, no opacity changes */
        .timeline-carousel {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Ensure carousel images stay visible */
        .timeline-carousel .carousel-image {
            opacity: 1 !important;
        }
        
        /* Hide carousel after transition completes */
        #project-page.active ~ #home-page .timeline-carousel {
            opacity: 1 !important;
        }
        
        /* Home Page */
        .home-page {
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Custom cursor */
        html, body, * {
            cursor: none !important;
        }

        .custom-cursor {
            position: fixed;
            top: 0;
            left: 0;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(160, 160, 160, 0.28);
            border: 1px solid rgba(255, 255, 255, 0.22);
            mix-blend-mode: normal;
            pointer-events: none;
            transform: translate(-50%, -50%) scale(1);
            transition: transform 0.2s ease, width 0.2s ease, height 0.2s ease;
            z-index: 10001;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        @media (max-width: 768px) {
            .custom-cursor {
                display: none;
            }
        }

        body.cursor-small .custom-cursor {
            width: 20px;
            height: 20px;
        }
        
        /* Timeline Carousel */
        .timeline-carousel {
            position: fixed;
            top: calc(6.5rem + 7.5rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px));
            left: 50%;
            transform: translateX(calc(-50% + var(--carousel-pan-x, 0px)));
            transform-origin: center bottom;
            width: 260px;
            max-width: 260px;
            z-index: 10;
            background: transparent;
            overflow: visible;
            will-change: transform;
            backface-visibility: hidden;
            transition: left 2.2s cubic-bezier(0.16, 1, 0.3, 1),
                        top 2.2s cubic-bezier(0.16, 1, 0.3, 1),
                        transform 2.2s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .carousel-container {
            position: relative;
            width: 100%;
            overflow: hidden;
        }

        /* Web-only: laptop + phone pair */
        @media (min-width: 769px) {
            :root {
                --phone-image-height: 315px;
                --laptop-image-height: 410px;
            }

            .timeline-carousel {
                width: max-content;
                max-width: none;
            }

            .carousel-container {
                display: flex;
                align-items: flex-end;
                gap: 5.2rem;
                padding-left: 3.5rem;
                padding-right: 1rem;
                width: max-content;
                overflow: visible;
                cursor: grab;
                touch-action: pan-x;
                scrollbar-width: none;
                -ms-overflow-style: none;
                background: transparent;
            }

            .carousel-container.dragging {
                cursor: grabbing;
            }

            .carousel-item {
                display: flex;
                align-items: flex-end;
            }

            .image-stack {
                position: relative;
                display: inline-block;
            }

            .laptop-stack {
                height: var(--laptop-image-height, 330px);
            }

            .phone-stack {
                height: var(--phone-image-height);
                width: auto;
                transform: translateX(12px);
            }

            .image-stack .carousel-image {
                width: auto;
                height: 100%;
            }

            .laptop-stack .carousel-image {
                width: auto;
                height: 100%;
            }

            .image-stack .carousel-image.dark-image {
                position: absolute;
                inset: 0;
                width: 100%;
                height: 100%;
            }

            .carousel-item {
                transition: transform 2.2s cubic-bezier(0.16, 1, 0.3, 1);
                transform-origin: center bottom;
                will-change: transform;
            }

            .timeline-carousel.zoomed .carousel-item.active {
                opacity: 1;
                pointer-events: auto;
                transform: translateX(0) scale(var(--active-zoom-scale));
                transform-origin: center bottom;
                transition: transform 2.2s cubic-bezier(0.16, 1, 0.3, 1);
            }

            .project-landing .timeline-carousel.zoomed .carousel-item.active {
                transform: translateX(0) scale(1.42);
            }

            .timeline-carousel.zoomed .carousel-item.is-left {
                transform: translateX(-120vw) scale(1);
                opacity: 1;
            }

            .timeline-carousel.zoomed .carousel-item.is-right {
                transform: translateX(120vw) scale(1);
                opacity: 1;
            }

            .timeline-carousel:not(.zoomed) .carousel-item {
                opacity: 1;
                pointer-events: auto;
                transform: translateX(0);
            }

            .timeline-carousel.zoomed {
                width: max-content !important;
                max-width: none !important;
                top: calc(6.5rem + 7.5rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px)) !important;
                transform-origin: center bottom !important;
            }

            .timeline-carousel.zoomed .image-stack .carousel-image {
                width: 100% !important;
                height: auto !important;
            }

            .timeline-carousel.zoomed .laptop-stack .carousel-image {
                width: auto !important;
                height: 100% !important;
            }

            .timeline-carousel.zoomed .phone-stack .carousel-image {
                width: auto !important;
                height: 100% !important;
            }
        }
        
        .carousel-image {
            width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: default;
            -webkit-user-drag: none;
            user-select: none;
            backface-visibility: hidden;
            transform: translateZ(0);
            will-change: transform, opacity;
        }
        
        .carousel-image:hover {
            opacity: 0.8 !important;
        }
        
        [data-theme="dark"] .carousel-image.dark-image:hover {
            opacity: 0.8 !important;
        }
        
        .carousel-image.light-image {
            opacity: 1 !important;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .carousel-image.dark-image {
            opacity: 0 !important;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: auto;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        [data-theme="dark"] .carousel-image.light-image {
            opacity: 0 !important;
        }
        
        [data-theme="dark"] .carousel-image.dark-image {
            opacity: 1 !important;
        }
        
        /* Ensure theme switching works for zoomed carousel */
        .timeline-carousel.zoomed .carousel-image.light-image {
            opacity: 1 !important;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .timeline-carousel.zoomed .carousel-image.dark-image {
            opacity: 0 !important;
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: auto !important;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        [data-theme="dark"] .timeline-carousel.zoomed .carousel-image.light-image {
            opacity: 0 !important;
        }
        
        [data-theme="dark"] .timeline-carousel.zoomed .carousel-image.dark-image {
            opacity: 1 !important;
        }
        
        @media (max-width: 768px) {
            .timeline-carousel {
                width: max-content;
                max-width: none;
                left: 30px !important;
                margin-left: 0 !important;
                transform: translateX(0) translateY(-90px) !important;
                top: calc(6.5rem + 6.0rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px)) !important;
            }

            .carousel-item {
                display: block;
            }

            .carousel-item.active {
                display: block;
                transform: translateY(0) scale(1);
                transform-origin: center bottom;
            }

            .timeline-carousel.zoomed .carousel-item {
                display: block;
            }

            .carousel-container {
                display: flex;
                align-items: flex-end;
                gap: 1.25rem;
                overflow: visible;
                padding-left: 0;
            }

            .laptop-stack {
                height: 180px;
            }

            .phone-stack {
                height: 140px;
                width: auto;
                transform: translateX(0);
            }

            .image-stack {
                position: relative;
                display: inline-block;
            }

            .image-stack .carousel-image {
                width: auto;
                height: 100%;
            }

            .image-stack .carousel-image.dark-image {
                position: absolute;
                inset: 0;
                width: 100%;
                height: 100%;
            }

            .timeline-carousel.zoomed .carousel-item.active {
                transform: translateX(0) translateY(-80px) scale(var(--active-zoom-scale));
                transform-origin: center bottom;
                transition: transform 2.2s cubic-bezier(0.16, 1, 0.3, 1);
            }

            .timeline-carousel.zoomed .carousel-item.is-left {
                transform: translateX(-120vw) scale(1);
                transition: transform 1.4s cubic-bezier(0.16, 1, 0.3, 1);
            }

            .timeline-carousel.zoomed .carousel-item.is-right {
                transform: translateX(120vw) scale(1);
                transition: transform 1.4s cubic-bezier(0.16, 1, 0.3, 1);
            }

            .project-detail-overlay .project-left {
                opacity: 0;
                transition: opacity 0.35s ease;
                transition-delay: 0s;
            }

            .project-detail-overlay.active .project-left {
                opacity: 1;
                transition-delay: 2.2s;
            }
        }
        
        @media (max-width: 768px) {
            .home-page {
                z-index: 1;
            }

            .timeline-carousel {
                z-index: 3;
            }

            .home-page .name-section,
            .home-page .links-section {
                z-index: 1;
            }
        }
        
        @media (max-width: 480px) {
            .timeline-carousel {
                width: 150px;
                max-width: 150px;
            }
        }

        @media (max-width: 1600px) {
            .timeline-carousel {
                width: 230px;
                max-width: 230px;
            }

            .project-page-container {
                padding: 0 22rem;
            }

            .project-image-container {
                max-width: 520px !important;
            }

            .about-page-container {
                padding: 6.5rem 9rem;
            }

            .about-left {
                max-width: 380px;
            }

            .about-right {
                max-width: 34%;
                width: 34%;
            }

            .about-paragraph {
                font-size: 1.1rem;
            }

            .email-link,
            .about-link {
                font-size: 1.05rem;
            }
        }

        @media (max-width: 1400px) {
            .timeline-carousel {
                width: 210px;
                max-width: 210px;
            }

            .project-page-container {
                padding: 0 18rem;
            }

            .project-image-container {
                max-width: 480px !important;
            }

            .project-title {
                font-size: 1rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.85rem;
            }

            .project-contributor {
                font-size: 0.8rem;
            }

            .about-page-container {
                padding: 6rem 7rem;
            }

            .about-left {
                max-width: 360px;
            }

            .about-right {
                max-width: 32%;
                width: 32%;
            }

            .about-paragraph {
                font-size: 1rem;
                line-height: 1.35;
            }

            .email-link,
            .about-link {
                font-size: 0.95rem;
            }
        }

        @media (max-width: 1200px) {
            .timeline-carousel {
                width: 190px;
                max-width: 190px;
            }

            .project-page-container {
                padding: 0 14rem;
            }

            .project-image-container {
                max-width: 420px !important;
            }

            .project-title {
                font-size: 0.95rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.8rem;
            }

            .project-contributor {
                font-size: 0.75rem;
                white-space: normal;
            }

            .project-role,
            .project-design {
                white-space: normal;
            }

            .about-page-container {
                padding: 5.5rem 5rem;
            }

            .about-left {
                max-width: 320px;
            }

            .about-right {
                max-width: 36%;
                width: 36%;
                height: 44vh;
                min-height: 44vh;
            }

            .about-paragraph {
                font-size: 0.95rem;
                line-height: 1.32;
            }

            .email-link,
            .about-link {
                font-size: 0.9rem;
            }
        }

        @media (max-width: 1000px) {
            .timeline-carousel {
                width: 170px;
                max-width: 170px;
            }

            .project-page-container {
                padding: 0 10rem;
                gap: 1.5rem;
            }

            .project-image-container {
                max-width: 360px !important;
            }

            .project-title {
                font-size: 0.9rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.75rem;
            }

            .project-contributor {
                font-size: 0.7rem;
            }

            .about-page-container {
                padding: 5rem 3.5rem;
                gap: 3rem;
            }

            .about-left {
                max-width: 300px;
            }

            .about-right {
                max-width: 38%;
                width: 38%;
                height: 44vh;
                min-height: 44vh;
            }

            .about-paragraph {
                font-size: 0.88rem;
                line-height: 1.28;
            }

            .email-link,
            .about-link {
                font-size: 0.82rem;
            }
        }

        @media (max-width: 800px) {
            .timeline-carousel {
                width: 140px;
                max-width: 140px;
            }

            .timeline-carousel:not(.zoomed) {
                top: auto !important;
                bottom: clamp(1.5rem, 4vh, 3rem) !important;
            }

            .timeline-carousel.zoomed {
                top: auto !important;
                bottom: clamp(1.5rem, 4vh, 3rem) !important;
            }

            .project-page-container {
                padding: 0 7rem;
                gap: 1.25rem;
            }

            .project-image-container {
                max-width: 300px !important;
            }

            .project-title {
                font-size: 0.85rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.7rem;
            }

            .project-contributor {
                font-size: 0.65rem;
            }

            .about-page-container {
                padding: 4rem 3rem;
                gap: 2.5rem;
            }

            .about-left {
                max-width: clamp(220px, 48vw, 300px);
                width: clamp(220px, 48vw, 300px);
            }

            .about-right {
                max-width: clamp(170px, 30vw, 240px);
                width: clamp(170px, 30vw, 240px);
                height: auto;
                min-height: 0;
            }

            .about-image {
                filter: grayscale(100%) !important;
                -webkit-filter: grayscale(100%) !important;
            }

            .about-paragraph {
                font-size: 0.85rem;
                line-height: 1.28;
            }

            .email-link,
            .about-link {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 650px) {
            .timeline-carousel {
                width: 120px;
                max-width: 120px;
            }

            .timeline-carousel:not(.zoomed) {
                top: auto !important;
                bottom: clamp(1.2rem, 4vh, 2.5rem) !important;
            }

            .timeline-carousel.zoomed {
                top: auto !important;
                bottom: clamp(1.2rem, 4vh, 2.5rem) !important;
            }

            .project-page-container {
                padding: 0 4.5rem;
                gap: 1rem;
            }

            .project-image-container {
                max-width: 260px !important;
            }

            .project-title {
                font-size: 0.8rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.65rem;
            }

            .project-contributor {
                font-size: 0.6rem;
            }

            .about-page-container {
                padding: 3.5rem 2.5rem;
                gap: 2rem;
            }

            .about-left {
                max-width: clamp(200px, 52vw, 280px);
                width: clamp(200px, 52vw, 280px);
            }

            .about-right {
                max-width: clamp(160px, 32vw, 220px);
                width: clamp(160px, 32vw, 220px);
                height: auto;
                min-height: 0;
            }

            .about-image {
                filter: grayscale(100%) !important;
                -webkit-filter: grayscale(100%) !important;
            }

            .about-paragraph {
                font-size: 0.8rem;
                line-height: 1.25;
            }

            .email-link,
            .about-link {
                font-size: 0.75rem;
            }
        }

        @media (max-width: 570px) {
            .timeline-carousel {
                width: 105px;
                max-width: 105px;
            }

            .timeline-carousel:not(.zoomed) {
                top: auto !important;
                bottom: clamp(1rem, 4vh, 2rem) !important;
            }

            .timeline-carousel.zoomed {
                top: auto !important;
                bottom: clamp(1rem, 4vh, 2rem) !important;
            }

            .project-page-container {
                padding: 0 3.5rem;
                gap: 0.8rem;
            }

            .project-image-container {
                max-width: 230px !important;
            }

            .project-title {
                font-size: 0.75rem;
            }

            .project-role,
            .project-design,
            .project-year {
                font-size: 0.6rem;
            }

            .project-contributor {
                font-size: 0.55rem;
            }

            .about-page-container {
                padding: 3rem 2rem;
                gap: 1.5rem;
            }

            .about-left {
                max-width: clamp(180px, 58vw, 260px);
                width: clamp(180px, 58vw, 260px);
            }

            .about-right {
                max-width: clamp(150px, 30vw, 200px);
                width: clamp(150px, 30vw, 200px);
                height: auto;
                min-height: 0;
            }

            .about-image {
                filter: grayscale(100%) !important;
                -webkit-filter: grayscale(100%) !important;
            }

            .about-paragraph {
                font-size: 0.75rem;
                line-height: 1.22;
            }

            .email-link,
            .about-link {
                font-size: 0.7rem;
            }
        }
        
        /* Animate home page elements */
        .home-page.active .name-section,
        .home-page.active .links-section {
            animation: fadeInScaleUp 0.25s ease 0.05s both;
        }
        
        /* Toggle appears later (opacity only, no position shift) */
        .home-page.active .theme-toggle {
            animation: fadeInOnly 0.25s ease 0.3s both;
        }
        
        /* Don't animate home page elements when coming from project page */
        .home-page.active:not(.entering-from-about) .name-section,
        .home-page.active:not(.entering-from-about) .links-section {
            animation: none;
        }
        
        .home-page.active:not(.entering-from-about) .theme-toggle {
            animation: none;
        }
        
        /* Animate home page elements when coming from About */
        .home-page.entering-from-about.active .name-section,
        .home-page.entering-from-about.active .links-section {
            animation: fadeInFromBelow 0.25s ease 0.05s both;
        }
        
        /* Toggle appears later when coming from About */
        .home-page.entering-from-about.active .theme-toggle {
            animation: fadeInOnly 0.25s ease 0.3s both;
        }
        
        
        @keyframes fadeInScaleUp {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        /* Animate about page elements */
        #about-page.active .about-page-container {
            animation: fadeInFromAbove 0.25s ease 0.05s both;
        }
        
        body.about-active .top-controls .back-button {
            animation: fadeInFromAbove 0.25s ease 0.02s both;
        }
        
        /* Toggle appears later on About page */
        body.about-active .top-controls .theme-toggle {
            animation: fadeInOnly 0.25s ease 0.3s both;
        }
        
        @keyframes fadeInFromAbove {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(1.1);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Exit animations */
        #about-page.exiting .about-page-container,
        #about-page.exiting ~ .top-controls .back-button {
            animation: liftOut 0.25s ease both;
        }
        
        /* Toggle fades out earlier when leaving About page */
        #about-page.exiting ~ .top-controls .theme-toggle {
            animation: fadeOutOnly 0.25s ease 0s both;
        }
        
        @keyframes liftOut {
            to {
                opacity: 0;
                transform: translateY(-30px) scale(1.1);
            }
        }
        
        .home-page.exiting .name-section,
        .home-page.exiting .links-section {
            animation: shrinkOut 0.2s ease both;
        }
        
        /* Toggle fades out earlier when leaving home page */
        .home-page.exiting .theme-toggle {
            animation: fadeOutOnly 0.2s ease 0s both;
        }
        
        @keyframes shrinkOut {
            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }
        
        /* Home page elements enter from below when coming from About */
        .home-page.entering-from-about.active .name-section,
        .home-page.entering-from-about.active .links-section,
        .home-page.entering-from-about.active .theme-toggle {
            animation: fadeInOnly 0.25s ease 0.05s both;
        }

        @keyframes fadeInOnly {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOutOnly {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes fadeInFromBelow {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* About Page */
        #about-page {
            overflow: hidden;
        }
        
        /* Project Detail Page */
        #project-page {
            overflow: hidden;
        }
        
        /* Ensure image stays visible during transition */
        #project-page .project-image-container {
            opacity: 1 !important;
        }
        
        .project-page-container {
            display: flex;
            height: 100vh;
            padding: 0 30rem;
            gap: 2rem;
            align-items: center;
        }

        @media (min-width: 769px) {
            .project-page-container {
                justify-content: center;
                gap: clamp(1.5rem, 3vw, 3.5rem);
                padding: 0 clamp(8rem, 12vw, 20rem);
            }
        }

        .project-left {
            flex: 0 1 40%;
            max-width: clamp(300px, 31.25vw, 500px);
            min-width: 0;
        }
        
        .project-title {
            font-size: clamp(0.9rem, 1.2vw, 1.2rem);
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: clamp(0.3rem, 0.5vw, 0.5rem);
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.2;
            white-space: nowrap;
        }
        
        .project-role {
            font-size: clamp(0.75rem, 0.95vw, 0.95rem);
            font-weight: 400;
            color: var(--text-color);
            margin-bottom: clamp(0.1rem, 0.15vw, 0.15rem);
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.3;
            white-space: nowrap; /* Web view: keep on one line */
        }
        
        .project-design {
            font-size: clamp(0.75rem, 0.95vw, 0.95rem);
            font-weight: 400;
            color: var(--text-color);
            margin-bottom: clamp(0.1rem, 0.15vw, 0.15rem);
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.3;
            white-space: nowrap; /* Web view: keep on one line */
        }
        
        .project-company {
            font-size: 0.95rem;
            font-weight: 400;
            color: var(--text-color);
            margin-bottom: 0.15rem;
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.3;
            display: block;
        }
        
        .project-year {
            font-size: clamp(0.75rem, 0.95vw, 0.95rem);
            font-weight: 400;
            color: var(--text-color);
            margin-bottom: clamp(1.5rem, 2vw, 2.5rem); /* Equal spacing above symbol */
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1.3;
        }
        
        .project-video-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border: 2px solid var(--text-secondary);
            border-radius: 50%;
            color: var(--text-secondary);
            text-decoration: none;
            margin-bottom: 2rem;
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), border-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
            position: relative;
        }
        
        .project-video-link::before {
            content: 'â–¶';
            font-size: 1rem;
            margin-left: 3px;
        }
        
        .project-video-link:hover {
            color: var(--text-secondary-hover);
            border-color: var(--text-secondary-hover);
        }
        
        .project-contributors {
            display: flex;
            flex-direction: column;
            gap: 0.05rem;
            margin-top: clamp(1.5rem, 2vw, 2.5rem); /* Equal spacing below symbol - move contributors down */
        }
        
        .project-contributor {
            font-size: clamp(0.7rem, 0.875vw, 0.875rem);
            color: var(--text-secondary);
            font-weight: 300;
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            white-space: nowrap; /* Web view: keep names on one line */
        }

        
        .project-right {
            flex: 1;
            max-width: 60%;
            min-width: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
        }
        
        /* Web view: project-right in overlay - hide image, use zoomed carousel instead */
        .project-detail-overlay .project-content-container .project-right {
            display: none;
        }

        @media (min-width: 769px) {
            .timeline-carousel.zoomed {
                left: 140px !important;
                transform: translateX(0) !important;
            }

            .project-landing .timeline-carousel.zoomed {
                left: 520px !important;
                transform: translateX(0) !important;
            }

            .project-aiva .timeline-carousel.zoomed {
                left: -60px !important;
                transform: translateX(0) !important;
                top: calc(6.5rem + 7.5rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px)) !important;
                transform-origin: center bottom !important;
            }

            .project-aiva .project-content-container {
                left: 500px !important;
            }

            .project-aiva .timeline-carousel {
                transition: transform 1.9s cubic-bezier(0.16, 1, 0.3, 1), top 1.9s cubic-bezier(0.16, 1, 0.3, 1), left 1.9s cubic-bezier(0.16, 1, 0.3, 1);
            }

            .project-aiva .timeline-carousel.zoomed .carousel-image {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: auto;
                filter: none;
            }

            .project-landing .project-content-container {
                left: 220px !important;
            }
        }

        @media (min-width: 1800px) {
            :root {
                --carousel-pan-x: -320px;
            }

            .project-landing .timeline-carousel.zoomed {
                left: 580px !important;
            }

            .project-aiva .timeline-carousel.zoomed {
                left: 0px !important;
            }

            .project-landing .project-content-container {
                left: 280px !important;
            }

            .project-aiva .project-content-container {
                left: 560px !important;
            }
        }
        
        .project-right .project-image-container {
            width: 100%;
        }
        
        .project-image-container {
            position: relative;
            width: 100%;
            max-width: 600px !important;
            min-width: 0;
        }
        
        @media (max-width: 1600px) {
            .project-image-container {
                max-width: 37.5vw !important;
            }
        }
        
        @media (max-width: 1200px) {
            .project-image-container {
                max-width: 50vw !important;
            }
        }
        
        @media (max-width: 480px) {
            .project-image-container {
                max-width: 100% !important;
            }
        }
        
        .project-image {
            width: 100%;
            height: auto;
            object-fit: contain;
            display: block;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .project-image.light-image {
            opacity: 1;
        }
        
        .project-image.dark-image {
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        [data-theme="dark"] .project-image.light-image {
            opacity: 0;
        }
        
        [data-theme="dark"] .project-image.dark-image {
            opacity: 1;
        }
        
        /* Project detail overlay - same page zoom effect */
        .project-detail-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            z-index: 100;
            pointer-events: none;
            transition: opacity 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        visibility 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background-color: var(--bg-color);
        }
        
        .project-detail-overlay.active {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }
        
        /* Project back button */
        .project-back-button {
            opacity: 0;
            visibility: hidden;
            z-index: 103;
            transition: opacity 0.25s ease 0.1s, visibility 0.25s ease 0.1s;
            pointer-events: none;
        }
        
        .project-detail-overlay.active .project-back-button {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        
        /* Make image and text not trigger zoom out */
        .timeline-carousel.zoomed,
        .project-detail-overlay .project-left {
            pointer-events: none;
        }
        
        .project-detail-overlay.active .project-left {
            pointer-events: auto;
        }
        
        /* Project content container - web view: text moved further to the left */
        .project-content-container {
            display: flex;
            height: auto;
            padding: 0;
            gap: 4rem;
            align-items: center;
            justify-content: flex-start;
            position: fixed;
            top: 50%;
            left: 260px !important; /* Default text position */
            transform: translateY(-50%) !important; /* Only translate Y to center vertically */
            width: auto;
            max-width: 500px;
        }
        
        /* Carousel image zoom effect - smooth transition both ways */
        .timeline-carousel {
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                        top 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        bottom 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        left 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        right 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Calculate: original bottom = 100vh - 12.5rem - 260px */
        /* For equal padding when scaled: center should be at 50vh */
        /* So translateY needed = (50vh - scaled_height/2) - (100vh - 12.5rem - 260px - 260px/2) */
        /* Simplified: translateY = 50vh - scaled_height/2 - 100vh + 12.5rem + 260px + 130px */
        /* = -50vh - scaled_height/2 + 12.5rem + 390px */
        
        /* Web view: zoomed carousel - positioned slightly to the left, slightly smaller */
        .timeline-carousel.zoomed {
            position: fixed !important;
            top: calc(6.5rem + 7.5rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px)) !important;
            left: calc(50% + 140px) !important; /* Restore project-page horizontal position */
            transform-origin: center bottom !important;
            transform: translateX(-50%) !important; /* No container scale; active item scales */
            z-index: 101 !important;
            width: 260px !important;
            pointer-events: none;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .timeline-carousel.zoomed .carousel-image {
            width: 100%;
            height: auto;
        }
        
        /* Ensure theme switching works for zoomed carousel images */
        .timeline-carousel.zoomed .carousel-image.light-image {
            opacity: 1 !important;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .timeline-carousel.zoomed .carousel-image.dark-image {
            opacity: 0 !important;
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: auto !important;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        [data-theme="dark"] .timeline-carousel.zoomed .carousel-image.light-image {
            opacity: 0 !important;
        }
        
        [data-theme="dark"] .timeline-carousel.zoomed .carousel-image.dark-image {
            opacity: 1 !important;
        }
        
        /* Project text appears on left side - web view: side by side with image */
        .project-detail-overlay .project-content-container .project-left {
            position: relative;
            left: auto;
            top: auto;
            transform: none;
            opacity: 0;
            max-width: 500px;
            z-index: 102;
            transition: opacity 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s;
            pointer-events: none;
            padding-right: 0;
            margin-right: 0;
        }
        
        .project-detail-overlay.active .project-content-container .project-left {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Legacy support for old selector */
        .project-detail-overlay .project-left {
            position: relative;
            left: auto;
            top: auto;
            transform: none;
            opacity: 0;
            max-width: 500px;
            z-index: 102;
            transition: opacity 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.2s;
            pointer-events: none;
            padding-right: 0;
            margin-right: 0;
        }
        
        .project-detail-overlay.active .project-left {
            opacity: 1;
            pointer-events: auto;
        }
        
        
        /* Smooth fade out for text when zooming out */
        .project-detail-overlay:not(.active) .project-left {
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Hide home page elements when zoomed */
        .home-page.zoomed .name-section,
        .home-page.zoomed .links-section,
        .home-page.zoomed .theme-toggle {
            opacity: 0;
            transition: opacity 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        /* Ensure smooth reverse transition */
        .home-page:not(.zoomed) .name-section,
        .home-page:not(.zoomed) .links-section,
        .home-page:not(.zoomed) .theme-toggle {
            opacity: 1;
            transition: opacity 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) 0.2s;
        }

        /* Keep theme toggle visible and fixed */
        .top-controls .theme-toggle {
            opacity: 1 !important;
            transform: none !important;
        }

        #about-page.exiting ~ .top-controls .theme-toggle,
        .home-page.exiting .theme-toggle {
            animation: none !important;
            opacity: 1 !important;
        }
        
        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(30px);
            }
        }
        
        /* Web view only: Make all Aiva page text the same size as the title */
        .project-detail-overlay .project-content-container .project-title,
        .project-detail-overlay .project-content-container .project-role,
        .project-detail-overlay .project-content-container .project-design,
        .project-detail-overlay .project-content-container .project-company,
        .project-detail-overlay .project-content-container .project-year,
        .project-detail-overlay .project-content-container .project-contributor {
            font-size: clamp(0.9rem, 1.2vw, 1.2rem) !important;
        }
        
        /* Web view: Move title, role, design, year text up even more */
        .project-detail-overlay .project-content-container .project-title {
            margin-bottom: 0 !important; /* Move up even more */
        }
        
        .project-detail-overlay .project-content-container .project-role {
            margin-bottom: 0 !important; /* Move up even more */
        }
        
        .project-detail-overlay .project-content-container .project-design {
            margin-bottom: 0 !important; /* Move up even more */
        }
        
        .project-detail-overlay .project-content-container .project-year {
            margin-bottom: clamp(1rem, 2vw, 2rem) !important; /* Add even more spacing above symbol */
        }
        
        /* Web view: Move contributors down */
        .project-detail-overlay .project-content-container .project-contributors {
            margin-top: clamp(1.5rem, 2vw, 2.5rem) !important; /* Move down */
        }
        
        /* Project link arrow - diagonal arrow symbol with circle */
        .project-link-arrow {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2rem;
            height: 2rem;
            border: 2px solid var(--text-color);
            border-radius: 50%;
            font-size: clamp(0.9rem, 1.2vw, 1.2rem);
            color: var(--text-color);
            text-decoration: none;
            margin-bottom: clamp(0.5rem, 1vw, 1rem); /* Decreased padding */
            margin-top: clamp(0.5rem, 1vw, 1rem); /* Decreased padding */
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), border-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            line-height: 1;
        }
        
        .project-link-arrow:hover {
            color: var(--text-secondary-hover);
            border-color: var(--text-secondary-hover);
        }
        
        /* Web view: Position arrow to the right, centered with contributors */
        .project-detail-overlay .project-content-container .project-left {
            position: relative;
        }
        
        /* Position arrow on its own line between 2025 and Tyler Buchanan - maintain circle shape */
        .project-detail-overlay .project-content-container .project-link-arrow {
            font-size: clamp(0.9rem, 1.2vw, 1.2rem) !important;
            display: inline-flex !important; /* Keep inline-flex to maintain circle */
            align-items: center !important;
            justify-content: center !important;
            width: 2rem !important; /* Maintain circle width */
            height: 2rem !important; /* Maintain circle height */
            border: 2px solid var(--text-color) !important;
            border-radius: 50% !important; /* Maintain circle shape */
            position: static !important;
            margin-top: 0 !important;
            margin-bottom: 0 !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
            transform: none !important;
        }
        
        
        @media (max-width: 480px) {
            .project-page-container {
                flex-direction: column;
                padding: 4rem 5.5rem;
                gap: 3rem;
            }
            
            .project-left {
                flex: 1;
                max-width: 100%;
            }
            
            .project-right {
                width: 100%;
                max-width: 100%;
            }
            
            .project-image-container {
                max-width: 100% !important;
            }
        }
        
        @media (max-width: 480px) {
            .project-page-container {
                padding: 2.5rem 3.5rem;
            }
        }
        
        /* Dark Mode Variables */
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --text-secondary: #888888;
            --text-secondary-hover: #000000;
            --carousel-pan-x: -400px;
            --active-zoom-scale: 1.35;
        }
        
        [data-theme="dark"] {
            --bg-color: #000000;
            --text-color: #ffffff;
            --text-secondary: #888888;
            --text-secondary-hover: #ffffff;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Smooth transitions for all elements that change with theme */
        * {
            transition: background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), 
                        color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        border-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Only allow icon transitions for sun/moon swap */
        .theme-toggle .sun-icon,
        .theme-toggle .moon-icon {
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) !important;
        }
        
        /* Exclude elements that shouldn't transition */
        img, svg, canvas, video, iframe {
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        /* Top Controls (Back + Theme) */
        .top-controls {
            position: fixed;
            top: 3rem;
            left: 4rem;
            right: 4rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10001;
            pointer-events: none;
        }

        .top-controls .back-button {
            position: static;
            opacity: 0;
            pointer-events: none;
        }

        body.about-active .top-controls .about-back {
            opacity: 1;
            pointer-events: auto;
        }

        body.project-active .top-controls #project-back-button {
            opacity: 1;
            pointer-events: auto;
        }

        /* Ensure project back chevron stays top-left opposite the toggle */
        body.project-active #project-back-button {
            position: fixed;
            top: 3rem;
            left: 4rem;
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
            z-index: 10002;
        }

        /* Keep back button aligned with toggle padding */
        .top-controls .back-button {
            margin-left: 0;
        }

        /* Theme Toggle Button - Position and styling */
        .theme-toggle {
            position: static !important;
            z-index: 10001 !important;
            color: var(--text-secondary);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            transition: none !important;
            font-weight: 300;
            letter-spacing: 0.1em;
            line-height: 1;
            width: 1.75rem;
            height: 1.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1 !important;
            visibility: visible !important;
            pointer-events: auto;
        }
        
        .theme-toggle:hover {
            color: var(--text-secondary-hover);
        }
        
        .theme-toggle .sun-icon,
        .theme-toggle .moon-icon {
            position: absolute;
            top: 0;
            left: 0;
            display: inline-block;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            font-size: 1.4rem;
            line-height: 1;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            width: 1.4rem;
            height: 1.4rem;
            display: grid;
            place-items: center;
        }
        
        .theme-toggle .sun-icon {
            opacity: 1;
            transform: rotate(0deg) scale(1);
            width: 1em;
            height: 1em;
            display: inline-block;
            position: relative;
        }
        
        .theme-toggle .moon-icon {
            opacity: 0;
            transform: rotate(-90deg) scale(0);
        }
        
        [data-theme="dark"] .theme-toggle .sun-icon {
            opacity: 0;
            transform: rotate(90deg) scale(0);
        }
        
        [data-theme="dark"] .theme-toggle .moon-icon {
            opacity: 1;
            transform: rotate(0deg) scale(1);
        }

        /* Lock theme toggle icon alignment so it never shifts */
        .theme-toggle {
            position: fixed !important;
            top: 3rem;
            right: 4rem;
            left: auto !important;
        }

        .theme-toggle .sun-icon,
        .theme-toggle .moon-icon {
            position: absolute !important;
            inset: 0;
            width: 100%;
            height: 100%;
            display: grid;
            place-items: center;
        }

        /* CSS sun symbol (no emoji) */
        .theme-toggle .sun-icon::before {
            content: '';
            position: absolute;
            inset: 28% 28%;
            border-radius: 50%;
            background: currentColor;
        }

        .theme-toggle .sun-icon::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow:
                0 -9px 0 0 currentColor,
                0 9px 0 0 currentColor,
                -9px 0 0 0 currentColor,
                9px 0 0 0 currentColor,
                6px 6px 0 0 currentColor,
                -6px 6px 0 0 currentColor,
                6px -6px 0 0 currentColor,
                -6px -6px 0 0 currentColor;
            opacity: 0.9;
        }
        
        /* About Page Styles */
        .back-button {
            position: static;
            z-index: 1000;
            font-size: 1.75rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            font-weight: 300;
            letter-spacing: 0.1em;
            cursor: pointer;
        }
        
        .back-button:hover {
            color: var(--text-secondary-hover);
        }
        
        .about-page-container {
            display: flex;
            min-height: 100vh;
            padding: 6.5rem 12rem;
            gap: clamp(2rem, 4vw, 4rem);
            align-items: center;
            justify-content: center;
            transform-origin: center top;
            background-color: var(--bg-color);
            transition: background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .about-flex-group {
            display: flex;
            align-items: stretch;
            justify-content: flex-start;
            gap: 10px;
            width: auto;
            max-width: 1200px;
            min-width: 0;
            height: var(--about-image-height, auto);
            margin: 0 auto;
        }
        
        .about-left {
            flex: 1 1 0;
            width: var(--about-image-width, 100%);
            max-width: var(--about-image-width, 520px);
            min-width: 240px;
            background-color: transparent;
            transition: background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94),
                        transform 0.25s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            overflow: hidden;
            min-width: 0;
        }

        .about-text-wrap {
            width: 100%;
            max-width: 100%;
            transform-origin: top left;
            transform: scale(var(--about-text-scale, 1));
            transition: transform 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .about-right {
            flex: 1 1 0;
            width: 100%;
            max-width: 520px;
            min-width: 240px;
            height: 40vh;
            min-height: 40vh;
            background: none;
            display: flex !important;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            opacity: 1 !important;
            visibility: visible !important;
            transition: background-color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            min-width: 0;
        }
        
        #about-page.active .about-right {
            opacity: 1 !important;
            visibility: visible !important;
            display: flex !important;
        }
        
            .about-paragraph {
                font-size: clamp(0.95rem, 0.6vw + 0.8rem, 1.15rem);
                line-height: var(--about-text-line-height, 1.45);
                color: var(--text-color);
                margin-bottom: 1rem;
                font-weight: 300;
                transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                max-width: 100%;
                overflow-wrap: break-word;
                word-break: normal;
                hyphens: auto;
                flex: 1 1 auto;
                margin-bottom: 0.75rem;
            }
        
        .about-links {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
            max-width: 100%;
            margin-top: auto;
        }
        
            .email-link,
            .about-link {
                font-size: clamp(0.9rem, 0.5vw + 0.75rem, 1.1rem);
                color: var(--text-secondary);
                text-decoration: none;
                font-weight: 300;
                transition: color 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
                display: inline-block;
                max-width: 100%;
                overflow-wrap: break-word;
                word-break: normal;
                hyphens: auto;
            }
        
        .email-link:hover,
        .about-link:hover {
            color: var(--text-secondary-hover);
        }
        
        .about-image {
            max-width: 100%;
            max-height: 100%;
            width: 100%;
            height: auto;
            min-width: 0;
            min-height: 0;
            object-fit: contain;
            object-position: center;
            filter: none !important;
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
            position: relative;
            z-index: 1;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), filter 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: transparent;
        }
        
        /* Keep grayscale for desktop layout down to 570px; mobile overrides later */
        
        #about-page.active .about-image {
            opacity: 1 !important;
            visibility: visible !important;
            display: block !important;
        }
        
        @media (max-width: 480px) {
            .top-controls {
                top: clamp(2.2rem, 4.5vw, 3.2rem);
                left: clamp(2rem, 4.5vw, 2.5rem);
                right: clamp(2rem, 4.5vw, 2.5rem);
            }

            .theme-toggle {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
                /* Align vertically with chevron - match back button top position exactly */
                align-items: flex-start !important;
            }
            
            .theme-toggle:focus {
                outline: none !important;
            }
            
            .theme-toggle:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .theme-toggle .sun-icon,
            .theme-toggle .moon-icon {
                font-size: 1.4rem !important;
                width: 1.4rem !important;
                height: 1.4rem !important;
                text-align: center !important;
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
                /* Ensure symbols render as text, not emoji */
                font-variant-emoji: text;
                -webkit-font-feature-settings: "liga" off;
            }
            
            /* Mobile: Back button bigger, more horizontal padding */
            .back-button {
                font-size: clamp(2rem, 4vw, 2.5rem) !important;
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .back-button:focus {
                outline: none !important;
            }
            
            .back-button:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .project-back-button {
                font-size: clamp(2rem, 4vw, 2.5rem) !important;
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .project-back-button:focus {
                outline: none !important;
            }
            
            .project-back-button:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            /* Mobile: Name and year bigger, moved up higher, same horizontal padding as links */
            .name-section {
                position: fixed;
                top: auto;
                bottom: 60%;
                left: 0;
                padding: clamp(2rem, 4vw, 4rem) clamp(3rem, 8vw, 5.5rem);
                padding-bottom: 0;
                padding-left: clamp(3rem, 8vw, 5.5rem) !important;
                padding-right: clamp(3rem, 8vw, 5.5rem) !important;
                transform: translateY(0);
            }
            
            .name {
                font-size: clamp(2rem, 5vw, 2.5rem) !important;
                margin-bottom: clamp(0.1rem, 0.15vw, 0.15rem) !important;
            }
            
            .year {
                font-size: clamp(2rem, 5vw, 2.5rem) !important;
                margin-bottom: clamp(0.1rem, 0.15vw, 0.15rem) !important;
            }
            
            /* Mobile: Links right underneath year text, almost zero spacing, same horizontal padding */
            .links-section {
                position: fixed;
                top: auto;
                bottom: 60%;
                left: 0;
                padding: 0 clamp(3rem, 8vw, 5.5rem);
                padding-top: 0;
                transform: translateY(calc(100% - 2.5rem));
                flex-direction: column;
                align-items: flex-start;
                gap: clamp(0.05rem, 0.1vw, 0.1rem);
            }
            
            .nav-link {
                font-size: clamp(1.25rem, 3vw, 1.5rem) !important;
            }
            
            /* Mobile: Carousel image on bottom half */
            .timeline-carousel {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 50%;
                transform: translateX(-50%);
                width: clamp(150px, 35vw, 220px);
                max-width: clamp(150px, 35vw, 220px);
                padding-bottom: clamp(2rem, 5vh, 4rem);
            }
            
            /* Mobile: About page - simple layout matching reference, same horizontal padding as home page */
            .about-page-container {
                flex-direction: column;
                padding: 0;
                gap: 0;
                align-items: stretch;
            }

            /* Mobile: reset About layout to simple stacked flow */
            .about-flex-group {
                flex-direction: column !important;
                height: auto !important;
                gap: clamp(1.5rem, 3vw, 2rem) !important;
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                align-items: flex-start !important;
            }

            .about-left {
                width: 100% !important;
                max-width: 100% !important;
                min-width: 0 !important;
                height: auto !important;
                overflow: visible !important;
            }

            .about-text-wrap {
                transform: none !important;
                height: auto !important;
            }

            .about-links {
                margin-top: 0 !important;
            }
            
            /* Mobile: Completely reset about-right for mobile */
            .about-right {
                order: -1 !important;
                width: 100% !important;
                max-width: 100% !important;
                height: clamp(220px, 50vw, 320px) !important;
                min-height: clamp(220px, 50vw, 320px) !important;
                max-height: none !important;
                padding-top: clamp(1.5rem, 3vw, 3rem) !important;
                padding-left: clamp(1rem, 3vw, 2rem) !important;
                padding-right: clamp(1rem, 3vw, 2rem) !important;
                padding-bottom: 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                background: none !important;
                opacity: 1 !important;
                visibility: visible !important;
                overflow: visible !important;
                position: relative !important;
                flex: none !important;
                z-index: 2 !important;
            }

            .about-left {
                z-index: 1 !important;
            }
            
            /* Force about-right to be visible */
            #about-page.active .about-right,
            #about-page .about-right,
            #about-page.active .about-page-container .about-right,
            #about-page .about-page-container .about-right,
            .about-page-container .about-right {
                opacity: 1 !important;
                visibility: visible !important;
                display: flex !important;
                height: auto !important;
                min-height: 0 !important;
                max-height: none !important;
            }
            
            /* Mobile: Completely reset about-image for mobile */
            .about-image {
                width: 100% !important;
                max-width: 100% !important;
                height: 100% !important;
                min-width: 0 !important;
                min-height: 0 !important;
                max-height: none !important;
                object-fit: contain !important;
                object-position: center !important;
                display: block !important;
                opacity: 1 !important;
                visibility: visible !important;
                background: none !important;
                background-color: transparent !important;
                filter: none !important;
                -webkit-filter: none !important;
                mix-blend-mode: normal !important;
                position: relative !important;
                z-index: 10 !important;
            }
            
            /* Force about-image to be visible with all possible selectors */
            #about-page.active .about-image,
            #about-page .about-image,
            #about-page.active .about-right .about-image,
            #about-page .about-right .about-image,
            .about-right .about-image,
            .about-right img,
            img.about-image,
            #about-page.active .about-page-container .about-image,
            #about-page .about-page-container .about-image,
            .about-page-container .about-image,
            .about-page-container img {
                width: 100% !important;
                max-width: 100% !important;
                height: auto !important;
                min-width: 0 !important;
                min-height: 0 !important;
                max-height: none !important;
                display: block !important;
                opacity: 1 !important;
                visibility: visible !important;
                background: none !important;
                background-color: transparent !important;
                filter: none !important;
                -webkit-filter: none !important;
                mix-blend-mode: normal !important;
            }
            
            .about-left {
                width: 100%;
                padding-left: clamp(1rem, 3vw, 2rem) !important;
                padding-right: clamp(1rem, 3vw, 2rem) !important;
                padding-top: clamp(1.5rem, 3.5vw, 2.5rem) !important;
                padding-bottom: clamp(4rem, 8vw, 6.5rem);
            }
            
            /* Mobile: Bigger bio and links text */
            .about-paragraph {
                font-size: clamp(1rem, 2.5vw, 1.2rem) !important;
                line-height: 1.5 !important;
            }
            
            .email-link,
            .about-link {
                font-size: clamp(1rem, 2.5vw, 1.2rem) !important;
            }
            
            .project-page-container {
                padding: clamp(2rem, 4vw, 4rem) clamp(3rem, 8vw, 5.5rem);
                gap: clamp(2rem, 4vw, 3rem);
            }
            
            .project-left {
                flex: 1;
                max-width: 100%;
            }
            
            .project-right {
                width: 100%;
                max-width: 100%;
            }
            
            .project-image-container {
                max-width: 100% !important;
                min-width: 0;
            }
            
            /* Mobile: Project overlay - image larger and lower (text stays put) */
            .timeline-carousel.zoomed {
                top: 102vh !important;
                left: 50% !important;
                transform-origin: center bottom !important;
                transform: translateX(-50%) translateY(-50%) scale(4.0) !important;
            }

            .project-landing .timeline-carousel.zoomed {
                left: 90% !important;
                top: 96vh !important;
                transform: translateX(-50%) translateY(-50%) scale(3.8) !important;
            }

            .project-aiva .timeline-carousel.zoomed {
                left: 14% !important;
                top: 82vh !important;
                transform: translateX(-50%) translateY(-50%) scale(2.75) !important;
            }

            .timeline-carousel.zoomed .carousel-image {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: auto;
                filter: none;
            }
            
            /* Mobile: Project content container - positioned below zoomed image */
            .project-detail-overlay .project-content-container {
                position: fixed !important;
                top: calc(26vh + 260px) !important;
                left: 50% !important;
                transform: translateX(-50%) translateX(55px) !important;
                width: 100% !important;
                max-width: 520px !important;
                display: flex !important;
                justify-content: space-between !important;
                align-items: flex-start !important;
                padding: 0 clamp(2.5rem, 6vw, 4.5rem) !important;
                height: auto !important;
            }
            
            /* Mobile: Project left - title and year only */
            .project-detail-overlay .project-left {
                position: relative !important;
                left: auto !important;
                top: auto !important;
                transform: none !important;
                flex: 0 0 auto !important;
                max-width: 320px !important;
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                column-gap: clamp(2rem, 5vw, 3rem) !important;
                align-items: start !important;
                margin-top: 12px !important;
            }

            .project-detail-overlay .project-left > * {
                grid-column: 1;
                margin-top: 0 !important;
            }
            
            /* Mobile: Show role and design on mobile */
            .project-detail-overlay .project-role,
            .project-detail-overlay .project-design {
                display: block !important;
                font-size: clamp(1.2rem, 3.2vw, 1.5rem) !important;
            }

            .project-detail-overlay .project-company {
                display: block !important;
                font-size: clamp(1.2rem, 3.2vw, 1.5rem) !important;
            }
            
            /* Mobile: Project right - contributors only (no image) */
            .project-detail-overlay .project-right {
                display: flex !important;
                flex: 0 0 auto !important;
                max-width: 220px !important;
                align-items: flex-start !important;
                justify-content: flex-end !important;
            }

            .project-detail-overlay .project-right .project-image-container {
                display: none !important;
            }

            /* Mobile: Contributors on the right column */
            .project-detail-overlay .project-contributors {
                grid-column: 2 !important;
                grid-row: 1 / span 6 !important;
                justify-self: start !important;
                text-align: left !important;
                margin-top: -70px !important;
                transform: translateY(-28px) !important;
                padding-top: 0 !important;
                align-self: start !important;
                margin-bottom: 0 !important;
            }

            .project-detail-overlay .project-contributor {
                font-size: clamp(1.2rem, 3.2vw, 1.5rem) !important;
            }

            .project-detail-overlay .project-title,
            .project-detail-overlay .project-year {
                font-size: clamp(1.2rem, 3.2vw, 1.5rem) !important;
            }

            /* Mobile: Smooth opacity fades to avoid blink on zoom out */
            .name-section,
            .links-section,
            .theme-toggle,
            .project-detail-overlay .project-left {
                transition: opacity 0.35s ease !important;
            }

        }
        
        @media (max-width: 480px) {
            .theme-toggle {
                top: clamp(1.8rem, 3.5vw, 2.3rem) !important;
                right: clamp(1.5rem, 3.5vw, 2rem) !important;
                left: auto !important;
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
                /* Align vertically with chevron - match back button top position exactly */
                align-items: flex-start !important;
            }
            
            /* Mobile: Theme toggle aligned vertically with back button */
            .back-button {
                top: clamp(1rem, 2vw, 1.5rem) !important;
            }
            
            .project-back-button {
                top: clamp(1rem, 2vw, 1.5rem) !important;
            }
            
            .theme-toggle:focus {
                outline: none !important;
            }
            
            .theme-toggle:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .theme-toggle .sun-icon,
            .theme-toggle .moon-icon {
                font-size: 1.4rem !important;
                width: 1.4rem !important;
                height: 1.4rem !important;
                text-align: center !important;
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
                /* Ensure symbols render as text, not emoji */
                font-variant-emoji: text;
                -webkit-font-feature-settings: "liga" off;
            }
            
            /* Mobile: Back button bigger, more horizontal padding */
            .back-button {
                top: clamp(1rem, 2vw, 1.5rem);
                left: clamp(1.5rem, 3.5vw, 2rem) !important;
                font-size: clamp(2rem, 4vw, 2.5rem) !important;
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .back-button:focus {
                outline: none !important;
            }
            
            .back-button:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .project-back-button {
                font-size: clamp(2rem, 4vw, 2.5rem) !important;
                left: clamp(1.5rem, 3.5vw, 2rem) !important;
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .project-back-button:focus {
                outline: none !important;
            }
            
            .project-back-button:active {
                outline: none !important;
                -webkit-tap-highlight-color: transparent !important;
            }
            
            .name-section {
                padding: clamp(1.5rem, 3vw, 2.5rem) clamp(2rem, 5vw, 3.5rem);
            }
            
            .links-section {
                padding: clamp(1.5rem, 3vw, 2.5rem) clamp(3rem, 7vw, 5.5rem) clamp(1.5rem, 3vw, 2.5rem) clamp(2rem, 5vw, 3.5rem);
            }
            
            .about-page-container {
                padding: clamp(1.5rem, 3vw, 2.5rem) clamp(2rem, 5vw, 3.5rem);
            }
            
            .project-page-container {
                padding: clamp(1.5rem, 3vw, 4rem) clamp(2rem, 5vw, 5.5rem);
            }
        }
    </style>
</head>
<body>
    <!-- Home Page -->
    <div id="home-page" class="page home-page active">
        
        <!-- Name and Year - Top Left -->
        <div class="name-section">
            <h1 class="name">Tyler Buchanan</h1>
            <p class="year">2026</p>
        </div>
        
        <!-- Timeline Carousel -->
        <div class="timeline-carousel">
            <div class="carousel-container" id="carousel-container">
                <div class="carousel-item" data-project="landing">
                    <div class="image-stack laptop-stack">
                        <img src="Arceus-Landing@3x.png" alt="Landing Page" class="carousel-image light-image">
                        <img src="Arceus-Landing@3x.png" alt="Landing Page" class="carousel-image dark-image">
                    </div>
                </div>
                <div class="carousel-item active" data-project="aiva">
                    <div class="image-stack phone-stack">
                        <img src="Aiva-Light@3x.png" alt="Aiva Project" class="carousel-image light-image">
                        <img src="Aiva-Dark@3a.png" alt="Aiva Project" class="carousel-image dark-image">
                    </div>
                </div>
            </div>
        </div>

        <!-- Links - Top Right -->
        <nav class="links-section">
            <a href="#" class="nav-link" data-page="about">About</a>
            <a href="https://github.com/Buchanz" target="_blank" class="nav-link">GitHub</a>
            <a href="https://www.linkedin.com/in/tyler-buchanan-b8bb29230" target="_blank" class="nav-link">LinkedIn</a>
        </nav>

        <!-- Main Content Area - Will hold device mockups later -->
        <main class="main-content">
            <!-- Device mockups will go here -->
        </main>
        
        <!-- Project Detail Overlay - Zoom Effect -->
        <div class="project-detail-overlay" id="project-overlay">
            
            <!-- Project Content -->
            <div class="project-content-container">
                <div class="project-left">
                    <h2 class="project-title">Aiva</h2>
                    <p class="project-role">Co-Founder</p>
                    <p class="project-design">Interface Design</p>
                    <p class="project-company">Arceus</p>
                    <p class="project-year">2025</p>
                    <a href="https://arceus.ca" target="_blank" class="project-link-arrow">â†—</a>
                    
                    <div class="project-contributors">
                        <span class="project-contributor">Tyler Buchanan</span>
                        <span class="project-contributor">Ivan Guo</span>
                        <span class="project-contributor">Sam Gupta</span>
                        <span class="project-contributor">Dujin Kim</span>
                    </div>
                </div>
                <div class="project-right">
                    <div class="project-image-container">
                        <img src="project-light.png" alt="Aiva Project" class="project-image light-image">
                        <img src="project-dark.png" alt="Aiva Project" class="project-image dark-image">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- About Page -->
    <div id="about-page" class="page">

        <!-- About Content -->
        <div class="about-page-container">
            <div class="about-flex-group">
                <div class="about-left">
                    <div class="about-text-wrap">
                        <p class="about-paragraph">
                            Tyler Buchanan is an entrepreneur and interface designer based in Vancouver, British Columbia. His work can be seen in products from his work with Arceus building Aiva. He is currently working on new projects while extending his education. Outside of design, Tyler spends his free time mountain biking, snowboarding, rock climbing, and birding.
                        </p>
                        <div class="about-links">
                            <a href="mailto:tyler.buchanan.a@gmail.com" class="email-link">Email</a>
                            <a href="https://github.com/Buchanz" target="_blank" class="about-link">GitHub</a>
                            <a href="https://www.linkedin.com/in/tyler-buchanan-b8bb29230" target="_blank" class="about-link">LinkedIn</a>
                        </div>
                    </div>
                </div>
                
                <div class="about-right">
                    <img src="about-image.png?v=19" alt="Tyler Buchanan" class="about-image" loading="eager">
                </div>
            </div>
        </div>
    </div>

    <!-- Project Detail Page -->
    <div id="project-page" class="page">

        <!-- Project Content -->
        <div class="project-page-container">
            <div class="project-left">
                <h2 class="project-title">Aiva</h2>
                <p class="project-role">Co-Founder</p>
                <p class="project-design">Interface Design</p>
                <p class="project-company">Arceus</p>
                <p class="project-year">2025</p>
                
                <div class="project-contributors">
                    <span class="project-contributor">Tyler Buchanan</span>
                    <span class="project-contributor">Ivan Guo</span>
                    <span class="project-contributor">Sam Gupta</span>
                    <span class="project-contributor">Dujin Kim</span>
                </div>
            </div>
            
            <div class="project-right">
                <div class="project-image-container">
                    <img src="project-light.png" alt="Project Detail" class="project-image light-image">
                    <img src="project-dark.png" alt="Project Detail" class="project-image dark-image">
                </div>
            </div>
        </div>
    </div>

    <!-- Top Controls (Back + Theme) -->
    <div class="top-controls">
        <a href="#" class="back-button about-back" data-page="home">â€¹</a>
        <a href="#" class="back-button project-back-button" id="project-back-button">â€¹</a>
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
            <span class="sun-icon"></span>
            <span class="moon-icon">â˜¾</span>
        </button>
    </div>

    <script>
        // Simple page transition with animations
        function showPage(pageId) {
            console.log('showPage called with:', pageId);
            // Get all pages
            const pages = document.querySelectorAll('.page');
            const currentActive = document.querySelector('.page.active');
            
            
            // Add exiting class to current page
            if (currentActive) {
                currentActive.classList.add('exiting');
                currentActive.classList.remove('active');
            }
            
            // Special handling for transition from About to Home
            if (pageId === 'home-page' && currentActive && currentActive.id === 'about-page') {
                const target = document.getElementById(pageId);
                if (target) {
                    target.classList.add('entering-from-about');
                }
            }
            
            // Special handling for transition from Home to About
            if (pageId === 'about-page' && currentActive && currentActive.id === 'home-page') {
                // Home page should fade out normally (not marked as exiting-to-project)
                // This is already handled above
            }
            
            // Delay to allow exit animation to play
            const delay = currentActive && currentActive.id === 'project-page' ? 1500 : 200;
            setTimeout(() => {
                // Remove exiting class from all pages
                pages.forEach(page => {
                    page.classList.remove('exiting');
                    page.classList.remove('entering-from-about');
                });
                
                // Add active class to target page
                const target = document.getElementById(pageId);
                if (target) {
                    target.classList.add('active');

                    document.body.classList.toggle('about-active', pageId === 'about-page');
                    document.body.classList.toggle('home-active', pageId === 'home-page');
                    
                    // Update overflow
                    if (pageId === 'home-page' || pageId === 'project-page') {
                        document.body.style.overflow = 'hidden';
                        document.documentElement.style.overflow = 'hidden';
                    } else {
                        document.body.style.overflow = 'auto';
                        document.documentElement.style.overflow = 'auto';
                    }
                    
                    if (pageId === 'about-page') {
                        alignAboutTextToImageTop();
                        fitAboutTextToImageBelow800();
                    }
                    
                }
            }, delay);
        }

        // Align home carousel bottom padding to match project page image bottom padding (desktop only)
        function alignHomeCarouselToProjectBottom() {
            const root = document.documentElement;
            const isDesktop = window.matchMedia('(min-width: 769px)').matches;
            if (!isDesktop) {
                root.style.setProperty('--carousel-offset', '0px');
                return;
            }

            const homeImage = document.querySelector('.timeline-carousel .carousel-item[data-project="aiva"] .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image');
            const projectImage = document.querySelector('#project-page .project-image.light-image') ||
                document.querySelector('#project-page .project-image');

            if (!homeImage || !projectImage) return;

            const waitForImage = (img) => new Promise((resolve) => {
                if (img.complete && img.naturalWidth > 0) return resolve();
                img.addEventListener('load', () => resolve(), { once: true });
            });

            Promise.all([waitForImage(homeImage), waitForImage(projectImage)]).then(() => {
                requestAnimationFrame(() => {
                    const homeRect = homeImage.getBoundingClientRect();
                    const projectRect = projectImage.getBoundingClientRect();
                    if (!homeRect.height || !projectRect.height) return;
                    const projectBottomPadding = window.innerHeight - projectRect.bottom;
                    const desiredHomeBottom = window.innerHeight - projectBottomPadding - 175;
                    const delta = desiredHomeBottom - homeRect.bottom;
                    root.style.setProperty('--carousel-offset', `${Math.round(delta)}px`);
                });
            });
        }

        // Align about text top with about image top (desktop only)
        function alignAboutTextToImageTop() {
            const isDesktop = window.matchMedia('(min-width: 769px)').matches;
            const aboutPage = document.getElementById('about-page');
            const aboutLeft = document.querySelector('.about-left');
            const aboutImage = document.querySelector('.about-image');

            if (!aboutLeft || !aboutImage) return;
            if (!isDesktop || !aboutPage || !aboutPage.classList.contains('active')) {
                aboutLeft.style.transform = '';
                return;
            }

            const waitForImage = (img) => new Promise((resolve) => {
                if (img.complete && img.naturalWidth > 0) return resolve();
                img.addEventListener('load', () => resolve(), { once: true });
            });

            waitForImage(aboutImage).then(() => {
                requestAnimationFrame(() => {
                    const textRect = aboutLeft.getBoundingClientRect();
                    const imageRect = aboutImage.getBoundingClientRect();
                    if (!textRect.height || !imageRect.height) return;
                    const delta = imageRect.top - textRect.top;
                    aboutLeft.style.transform = `translateY(${Math.round(delta)}px)`;
                });
            });
        }

        // Scale about text to fit within image height (all sizes)
        function fitAboutTextToImageBelow800() {
            const isDesktop = window.matchMedia('(min-width: 0px)').matches;
            const allowDynamic = true;
            const aboutPage = document.getElementById('about-page');
            const aboutLeft = document.querySelector('.about-left');
            const aboutWrap = document.querySelector('.about-text-wrap');
            const aboutImage = document.querySelector('.about-image');

            if (!aboutLeft || !aboutWrap || !aboutImage) return;
            if (!isDesktop || !allowDynamic || !aboutPage || !aboutPage.classList.contains('active')) {
                aboutLeft.style.removeProperty('--about-image-height');
                aboutLeft.style.setProperty('--about-text-scale', '1');
                return;
            }

            const waitForImage = (img) => new Promise((resolve) => {
                if (img.complete && img.naturalWidth > 0) return resolve();
                img.addEventListener('load', () => resolve(), { once: true });
            });

            let attempts = 0;
            const apply = () => {
                requestAnimationFrame(() => {
                    const imageRect = aboutImage.getBoundingClientRect();
                    if (!imageRect.height) {
                        if (attempts < 5) {
                            attempts += 1;
                            setTimeout(apply, 60);
                        }
                        return;
                    }

            const widthTarget = Math.max(120, Math.round(imageRect.width - 60));
            aboutLeft.style.setProperty('--about-image-height', `${Math.round(imageRect.height) + 60}px`);
            aboutLeft.style.setProperty('--about-image-width', `${widthTarget}px`);

                    // Measure at scale 1 to avoid feedback loops
                    aboutLeft.style.setProperty('--about-text-scale', '1');
                    const textHeight = aboutWrap.scrollHeight;
                    const maxHeight = imageRect.height;
                    if (!textHeight || !maxHeight) return;

                    const scaleByHeight = maxHeight / textHeight;
                    const scale = Math.min(1, scaleByHeight);
                    aboutLeft.style.setProperty('--about-text-scale', scale.toFixed(3));

                    // If there's extra space, gently expand line-height to fill the box
                    const fillRatio = textHeight ? (maxHeight / textHeight) : 1;
                    const lineHeight = Math.min(1.6, Math.max(1.2, 1.45 * fillRatio));
                    aboutLeft.style.setProperty('--about-text-line-height', lineHeight.toFixed(2));

                    alignAboutTextToImageTop();
                });
            };

            waitForImage(aboutImage).then(() => {
                apply();
            });
        }

        let carouselPaddingRatio = null;

        // Capture the current 1920 layout as baseline, then preserve top/bottom padding ratio
        // only below the chosen breakpoint (>=1800 stays locked).
        function initCarouselPaddingRatio() {
            const homeImage = document.querySelector('.timeline-carousel .carousel-item[data-project="aiva"] .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image');
            if (!homeImage) return;

            const waitForImage = (img) => new Promise((resolve) => {
                if (img.complete && img.naturalWidth > 0) return resolve();
                img.addEventListener('load', () => resolve(), { once: true });
            });

            waitForImage(homeImage).then(() => {
                requestAnimationFrame(() => {
                    const rect = homeImage.getBoundingClientRect();
                    const bottomPadding = window.innerHeight - rect.bottom;
                    if (!rect.height || bottomPadding <= 0) return;
                    carouselPaddingRatio = rect.top / bottomPadding;
                    applyCarouselPaddingRatio();
                });
            });
        }

        function applyCarouselPaddingRatio() {
            const root = document.documentElement;
            const isDesktop = window.matchMedia('(min-width: 769px)').matches;
            const allowDynamic = window.matchMedia('(max-width: 1799px)').matches;
            if (!isDesktop || !allowDynamic || carouselPaddingRatio === null) {
                alignHomeCarouselToProjectBottom();
                return;
            }

            const homeImage = document.querySelector('.timeline-carousel .carousel-item[data-project="aiva"] .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image.light-image') ||
                document.querySelector('.timeline-carousel .carousel-image');
            if (!homeImage) return;

            const rect = homeImage.getBoundingClientRect();
            if (!rect.height) return;

            const available = window.innerHeight - rect.height;
            if (available <= 0) return;

            const desiredTop = (carouselPaddingRatio * available) / (1 + carouselPaddingRatio);
            const minTop = 40;
            const maxTop = Math.max(minTop, window.innerHeight - rect.height - 40);
            const clampedTop = Math.min(Math.max(desiredTop, minTop), maxTop);
            const rem = parseFloat(getComputedStyle(document.documentElement).fontSize);
            const baseTop = (6.5 + 7.5) * rem;
            const offset = clampedTop - baseTop;
            root.style.setProperty('--carousel-offset', `${Math.round(offset)}px`);
        }

        const projects = {
            aiva: {
                title: 'Aiva',
                role: 'Co-Founder',
                design: 'Interface Design',
                company: 'Arceus',
                year: '2025',
                contributors: ['Tyler Buchanan', 'Ivan Guo', 'Sam Gupta', 'Dujin Kim'],
                link: 'https://arceus.ca',
                lightImage: 'project-light.png',
                darkImage: 'project-dark.png'
            },
            landing: {
                title: 'Landing Page',
                role: 'Co-Founder',
                design: 'Interface Design',
                company: 'Arceus',
                year: '2025',
                contributors: ['Tyler Buchanan'],
                link: 'https://arceus.ca',
                lightImage: 'Arceus-Landing@3x.png',
                darkImage: 'Arceus-Landing@3x.png'
            }
        };

        const mobileHiResProjects = {
            aiva: {
                light: 'Aiva-Light@3x.png',
                dark: 'Aiva-Dark@3a.png'
            },
            landing: {
                light: 'Arceus-Landing@3x.png',
                dark: 'Arceus-Landing@3x.png'
            }
        };

        let currentProjectId = 'aiva';
        let activeZoomScale = 1.35;
        let activeZoomLeftPx = 140;

        function setActiveProject(projectId) {
            const data = projects[projectId];
            if (!data) return;

            document.body.classList.toggle('project-landing', projectId === 'landing');
            document.body.classList.toggle('project-aiva', projectId === 'aiva');
            currentProjectId = projectId;
            if (projectId === 'aiva') {
                activeZoomScale = 1.9;
                activeZoomLeftPx = -740;
            } else if (projectId === 'landing') {
                activeZoomScale = 1.35;
                activeZoomLeftPx = 400;
            } else {
                activeZoomScale = 1.35;
                activeZoomLeftPx = 140;
            }
            document.documentElement.style.setProperty('--active-zoom-scale', activeZoomScale.toFixed(3));

            document.querySelectorAll('.project-title').forEach(el => { el.textContent = data.title; });
            document.querySelectorAll('.project-role').forEach(el => { el.textContent = data.role; });
            document.querySelectorAll('.project-design').forEach(el => { el.textContent = data.design; });
            document.querySelectorAll('.project-company').forEach(el => { el.textContent = data.company; });
            document.querySelectorAll('.project-year').forEach(el => { el.textContent = data.year; });
            document.querySelectorAll('.project-link-arrow').forEach(el => { el.setAttribute('href', data.link); });

            document.querySelectorAll('.project-contributors').forEach(el => {
                el.innerHTML = data.contributors.map(name => `<span class="project-contributor">${name}</span>`).join('');
            });

            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const hiResMobile = mobileHiResProjects[projectId];
            const hiResDesktop = !isMobile
                ? (projectId === 'aiva'
                    ? { light: 'Aiva-Light@3x.png', dark: 'Aiva-Dark@3a.png' }
                    : { light: 'Arceus-Landing@3x.png', dark: 'Arceus-Landing@3x.png' })
                : null;
            const hiRes = isMobile ? hiResMobile : hiResDesktop;
            const hiLight = hiRes ? hiRes.light : data.lightImage;
            const hiDark = hiRes ? hiRes.dark : data.darkImage;

            document.querySelectorAll('.project-image.light-image').forEach(el => {
                el.dataset.lowSrc = data.lightImage;
                el.dataset.hiSrc = hiLight;
                el.setAttribute('src', data.lightImage);
            });
            document.querySelectorAll('.project-image.dark-image').forEach(el => {
                el.dataset.lowSrc = data.darkImage;
                el.dataset.hiSrc = hiDark;
                el.setAttribute('src', data.darkImage);
            });

            const overlay = document.getElementById('project-overlay');
            if (overlay && overlay.classList.contains('active')) {
                swapProjectImages(true);
            }
        }

        function swapProjectImages(useHiRes) {
            document.querySelectorAll('.project-image.light-image').forEach(el => {
                const nextSrc = useHiRes ? (el.dataset.hiSrc || el.src) : (el.dataset.lowSrc || el.src);
                if (nextSrc && el.getAttribute('src') !== nextSrc) {
                    el.setAttribute('src', nextSrc);
                }
            });
            document.querySelectorAll('.project-image.dark-image').forEach(el => {
                const nextSrc = useHiRes ? (el.dataset.hiSrc || el.src) : (el.dataset.lowSrc || el.src);
                if (nextSrc && el.getAttribute('src') !== nextSrc) {
                    el.setAttribute('src', nextSrc);
                }
            });
        }

        function setActiveCarouselItem(item) {
            if (!item) return;
            const items = Array.from(document.querySelectorAll('.carousel-item'));
            const activeIndex = items.indexOf(item);
            items.forEach((el, idx) => {
                el.classList.toggle('active', el === item);
                el.classList.toggle('is-left', idx < activeIndex);
                el.classList.toggle('is-right', idx > activeIndex);
            });
        }

        function updateCarouselBreakpointOffset() {
            const root = document.documentElement;
            const bpOffset = window.matchMedia('(max-width: 1600px)').matches ? 60 : 0;
            root.style.setProperty('--carousel-bp-offset', `${bpOffset}px`);
        }

        // Theme toggle functionality
        function initTheme() {
            const themeToggles = document.querySelectorAll('.theme-toggle');
            const currentTheme = localStorage.getItem('theme') || 'light';
            
            // Set initial theme
            document.documentElement.setAttribute('data-theme', currentTheme);
            
            // Handle theme toggle clicks on all toggle buttons
            themeToggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const root = document.documentElement;
                    const currentTheme = root.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

                    // Temporarily disable image transitions to avoid blur
                    root.classList.add('theme-instant');
                    root.setAttribute('data-theme', newTheme);
                    localStorage.setItem('theme', newTheme);

                    setTimeout(() => {
                        root.classList.remove('theme-instant');
                    }, 150);
                });
            });
            
        }

        // Wait for page to load
        window.addEventListener('load', function() {
            console.log('Page loaded, setting up event listeners');
            
            // Initialize theme
            initTheme();

            setActiveProject('aiva');
            setActiveCarouselItem(document.querySelector('.carousel-item[data-project="aiva"]') || document.querySelector('.carousel-item'));

            // Preserve carousel padding ratio below 1800px (keep 1920 locked)
            initCarouselPaddingRatio();
            window.addEventListener('resize', applyCarouselPaddingRatio);
            alignAboutTextToImageTop();
            window.addEventListener('resize', alignAboutTextToImageTop);
            fitAboutTextToImageBelow800();
            window.addEventListener('resize', fitAboutTextToImageBelow800);
            updateCarouselBreakpointOffset();
            window.addEventListener('resize', updateCarouselBreakpointOffset);

            let carouselDragMoved = false;
            let lastCarouselItem = null;

            function initCarouselDrag(container) {
                if (!container) return;
                const root = document.documentElement;
                let isDown = false;
                let startX = 0;
                let startPan = 0;

                container.addEventListener('pointerdown', function(e) {
                    if (e.button !== 0) return;
                    if (carouselEl && carouselEl.classList.contains('zoomed')) return;
                    const downItem = e.target.closest('.carousel-item');
                    if (downItem) {
                        lastCarouselItem = downItem;
                    }
                    isDown = true;
                    carouselDragMoved = false;
                    startX = e.pageX;
                    const panValue = getComputedStyle(root).getPropertyValue('--carousel-pan-x').trim();
                    startPan = panValue ? parseFloat(panValue) : 0;
                    container.classList.add('dragging');
                    container.setPointerCapture(e.pointerId);
                });

                container.addEventListener('pointermove', function(e) {
                    const hoverItem = e.target.closest('.carousel-item');
                    if (hoverItem) {
                        lastCarouselItem = hoverItem;
                    }
                    if (!isDown) return;
                    const dx = e.pageX - startX;
                    if (Math.abs(dx) > 6) {
                        carouselDragMoved = true;
                    }
                    const nextPan = Math.max(-220, Math.min(220, startPan + dx));
                    root.style.setProperty('--carousel-pan-x', `${Math.round(nextPan)}px`);
                });

                function endDrag(e) {
                    if (!isDown) return;
                    isDown = false;
                    container.classList.remove('dragging');
                    try {
                        container.releasePointerCapture(e.pointerId);
                    } catch (err) {
                        // no-op
                    }
                    if (carouselDragMoved) {
                        setTimeout(() => {
                            carouselDragMoved = false;
                        }, 0);
                    }
                }

                container.addEventListener('pointerup', endDrag);
                container.addEventListener('pointercancel', endDrag);
                container.addEventListener('pointerleave', endDrag);
            }

            function initGlobalCarouselDrag(scope) {
                if (!scope) return;
                const root = document.documentElement;
                let isDown = false;
                let startX = 0;
                let startPan = 0;
                let panRaf = null;
                let pendingPan = null;
                let hasCapture = false;

                scope.addEventListener('pointerdown', function(e) {
                    if (e.button !== 0) return;
                    if (carouselEl && carouselEl.classList.contains('zoomed')) return;
                    if (e.target.closest('a, .back-button, .theme-toggle, .project-left, .project-right')) return;
                    isDown = true;
                    carouselDragMoved = false;
                    startX = e.pageX;
                    const panValue = getComputedStyle(root).getPropertyValue('--carousel-pan-x').trim();
                    startPan = panValue ? parseFloat(panValue) : 0;
                    hasCapture = false;
                });

                scope.addEventListener('pointermove', function(e) {
                    const hoverItem = e.target.closest('.carousel-item');
                    if (hoverItem) {
                        lastCarouselItem = hoverItem;
                    }
                    if (!isDown) return;
                    const dx = e.pageX - startX;
                    if (Math.abs(dx) > 6) {
                        carouselDragMoved = true;
                        if (!hasCapture) {
                            scope.setPointerCapture(e.pointerId);
                            hasCapture = true;
                        }
                    }
                    pendingPan = Math.max(-420, Math.min(420, startPan + dx));
                    if (!panRaf) {
                        panRaf = requestAnimationFrame(() => {
                            root.style.setProperty('--carousel-pan-x', `${Math.round(pendingPan)}px`);
                            panRaf = null;
                        });
                    }
                });

                function endDrag(e) {
                    if (!isDown) return;
                    isDown = false;
                    try {
                        if (hasCapture) {
                            scope.releasePointerCapture(e.pointerId);
                        }
                    } catch (err) {
                        // no-op
                    }
                    hasCapture = false;
                    if (carouselDragMoved) {
                        setTimeout(() => {
                            carouselDragMoved = false;
                        }, 0);
                    }
                }

                scope.addEventListener('pointerup', endDrag);
                scope.addEventListener('pointercancel', endDrag);
                scope.addEventListener('pointerleave', endDrag);
            }

            const basePhoneHeight = 220;
            const extraUp = -20;
            const phoneHeightVar = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--phone-image-height')) || basePhoneHeight;
            const delta = Math.round(phoneHeightVar - basePhoneHeight);
            document.documentElement.style.setProperty('--carousel-size-offset', `${-(delta + extraUp)}px`);

            // Function to zoom out
            function zoomOut() {
                const overlay = document.getElementById('project-overlay');
                const carouselEl = document.querySelector('.timeline-carousel');
                const homePage = document.getElementById('home-page');
                
                if (overlay && carouselEl && homePage) {
                    swapProjectImages(false);
                    document.body.classList.remove('project-active');
                    overlay.classList.remove('active');
                    carouselEl.classList.remove('zoomed');
                    homePage.classList.remove('zoomed');
                    // Reset manual zoom
                    carouselEl.style.transform = '';
                    carouselEl.dataset.manualZoom = '0';
                }
            }
            
            // Manual scroll zoom control - smooth and controlled, only zoom in on scroll up
            let manualZoomLevel = 1.0;
            const minZoom = 1.0;
            let maxZoom = activeZoomScale;
            const zoomStep = 0.03; // Larger step for more control
            const smoothTransition = 'transform 3.0s cubic-bezier(0.16, 1, 0.3, 1), top 3.0s cubic-bezier(0.16, 1, 0.3, 1), left 3.0s cubic-bezier(0.16, 1, 0.3, 1)';
            let zoomTargetLeftPx = activeZoomLeftPx;
            
            const carouselContainer = document.getElementById('carousel-container');
            const carouselEl = document.querySelector('.timeline-carousel');
            const homePage = document.getElementById('home-page');
            const overlay = document.getElementById('project-overlay');

            initCarouselDrag(carouselContainer);
            initGlobalCarouselDrag(homePage);

            if (homePage) {
                homePage.addEventListener('wheel', function(e) {
                    if (carouselEl && carouselEl.classList.contains('zoomed')) return;
                    if (!homePage.classList.contains('active')) return;
                    if (Math.abs(e.deltaX) <= Math.abs(e.deltaY)) return;
                    e.preventDefault();
                    const root = document.documentElement;
                    const panValue = getComputedStyle(root).getPropertyValue('--carousel-pan-x').trim();
                    const startPan = panValue ? parseFloat(panValue) : 0;
                    const nextPan = Math.max(-420, Math.min(420, startPan - e.deltaX));
                    root.style.setProperty('--carousel-pan-x', `${Math.round(nextPan)}px`);
                }, { passive: false });
            }

            const customCursor = document.createElement('div');
            customCursor.className = 'custom-cursor';
            document.body.appendChild(customCursor);

            let cursorX = 0;
            let cursorY = 0;
            let cursorRaf = null;
            function updateCursor() {
                customCursor.style.left = `${cursorX}px`;
                customCursor.style.top = `${cursorY}px`;
                cursorRaf = null;
            }
            document.addEventListener('pointermove', (e) => {
                cursorX = e.clientX;
                cursorY = e.clientY;
                customCursor.style.opacity = '1';
                if (!cursorRaf) {
                    cursorRaf = requestAnimationFrame(updateCursor);
                }
            });

            document.addEventListener('mouseleave', () => {
                customCursor.style.opacity = '0';
            });

            document.addEventListener('mouseenter', () => {
                customCursor.style.opacity = '1';
            });

            window.addEventListener('blur', () => {
                customCursor.style.opacity = '0';
            });

            window.addEventListener('focus', () => {
                customCursor.style.opacity = '1';
            });

            const hoverTargets = 'a, .back-button, .theme-toggle';
            document.body.addEventListener('mouseover', (e) => {
                if (e.target.closest(hoverTargets)) {
                    document.body.classList.add('cursor-small');
                }
            });

            document.body.addEventListener('mouseout', (e) => {
                if (e.target.closest(hoverTargets)) {
                    document.body.classList.remove('cursor-small');
                }
            });
            
            // Auto-complete zoom out when scrolling stops
            let scrollTimeout = null;
            let isZoomingOut = false;
            
            function applyZoom(level, overlay, homePage, carouselEl) {
                maxZoom = activeZoomScale;
                zoomTargetLeftPx = activeZoomLeftPx;
                const scale = level;
                const zoomFactor = (level - minZoom) / (maxZoom - minZoom);
                const clampedZoomFactor = Math.max(0, Math.min(1, zoomFactor));
                const isMobile = window.matchMedia('(max-width: 768px)').matches;

                if (isMobile) {
                    const fade = clampedZoomFactor;
                    const homeFade = clampedZoomFactor <= 0 ? 1 : 0;
                    const nameEl = document.querySelector('.name-section');
                    const linksEl = document.querySelector('.links-section');
                    const toggleEl = document.querySelector('.theme-toggle');
                    if (nameEl) nameEl.style.opacity = homeFade.toFixed(3);
                    if (linksEl) linksEl.style.opacity = homeFade.toFixed(3);
                    if (toggleEl) toggleEl.style.opacity = homeFade.toFixed(3);

                    const projectLeft = document.querySelector('.project-left');
                    if (projectLeft) {
                        projectLeft.style.opacity = fade.toFixed(3);
                    }

                    const overlayEl = document.getElementById('project-overlay');
                    if (overlayEl) {
                        overlayEl.style.opacity = fade.toFixed(3);
                        overlayEl.style.visibility = fade > 0 ? 'visible' : 'hidden';
                        overlayEl.style.pointerEvents = fade > 0 ? 'auto' : 'none';
                    }
                }
                
                if (level <= minZoom) {
                    carouselEl.style.position = '';
                    carouselEl.style.top = '';
                    carouselEl.style.left = '';
                    carouselEl.style.transform = '';
                    carouselEl.style.transformOrigin = '';
                    carouselEl.style.transition = smoothTransition;
                    carouselEl.dataset.manualZoom = '';
                    carouselEl.classList.remove('zoomed');
                    homePage.classList.remove('zoomed');
                    overlay.classList.remove('active');
                    overlay.style.opacity = '';
                    overlay.style.visibility = '';
                    overlay.style.pointerEvents = '';
                    
                    const projectLeft = document.querySelector('.project-left');
                    if (projectLeft) {
                        projectLeft.style.opacity = '';
                        projectLeft.style.visibility = '';
                    }
                } else {
                    carouselEl.style.setProperty('position', 'fixed', 'important');
                    updateCarouselBreakpointOffset();
                    carouselEl.style.setProperty('top', 'calc(6.5rem + 7.5rem + var(--carousel-offset, 0px) + var(--carousel-bp-offset, 0px) + var(--carousel-size-offset, 0px))', 'important');
                    carouselEl.style.setProperty('left', `calc(50% + ${zoomTargetLeftPx}px)`, 'important');
                    carouselEl.style.setProperty('transform', `translateX(-50%) scale(${scale})`, 'important');
                    carouselEl.style.setProperty('transform-origin', 'center bottom', 'important');
                    carouselEl.style.setProperty('z-index', '101', 'important');
                    carouselEl.style.transition = smoothTransition;
                    carouselEl.dataset.manualZoom = level.toString();
                    
                    if (level >= maxZoom) {
                        overlay.classList.add('active');
                        carouselEl.classList.add('zoomed');
                        homePage.classList.add('zoomed');
                        document.body.classList.add('project-active');
                        overlay.style.opacity = '';
                        overlay.style.visibility = '';
                        overlay.style.pointerEvents = '';
                        
                        const projectLeft = document.querySelector('.project-left');
                        if (projectLeft) {
                            projectLeft.style.opacity = '1';
                            projectLeft.style.visibility = 'visible';
                        }
                    } else {
                        overlay.style.opacity = '0';
                        overlay.style.visibility = 'hidden';
                        overlay.style.pointerEvents = 'none';
                        overlay.classList.remove('active');
                        carouselEl.classList.remove('zoomed');
                        homePage.classList.remove('zoomed');
                        
                        const projectLeft = document.querySelector('.project-left');
                        if (projectLeft) {
                            projectLeft.style.opacity = '0';
                            projectLeft.style.visibility = 'hidden';
                        }
                    }
                }
            }
            
            if (carouselContainer && carouselEl && overlay) {
                let swipeStartX = 0;
                let swipeStartY = 0;
                let isSwiping = false;

                overlay.addEventListener('pointerdown', function(e) {
                    if (e.button !== 0) return;
                    swipeStartX = e.clientX;
                    swipeStartY = e.clientY;
                    isSwiping = true;
                });

                overlay.addEventListener('pointermove', function(e) {
                    if (!isSwiping) return;
                    const dx = e.clientX - swipeStartX;
                    const dy = e.clientY - swipeStartY;
                    if (Math.abs(dx) < 60 || Math.abs(dx) < Math.abs(dy)) return;
                    isSwiping = false;

                    if (dx < 0) {
                        setActiveProject('landing');
                        setActiveCarouselItem(document.querySelector('.carousel-item[data-project=\"landing\"]'));
                    } else {
                        setActiveProject('aiva');
                        setActiveCarouselItem(document.querySelector('.carousel-item[data-project=\"aiva\"]'));
                    }
                });

                overlay.addEventListener('pointerup', function() {
                    isSwiping = false;
                });

                overlay.addEventListener('pointercancel', function() {
                    isSwiping = false;
                });

                overlay.addEventListener('wheel', function(e) {
                    if (!overlay.classList.contains('active')) return;
                    if (Math.abs(e.deltaX) <= Math.abs(e.deltaY)) return;
                    e.preventDefault();
                    if (e.deltaX > 0) {
                        setActiveProject('landing');
                        setActiveCarouselItem(document.querySelector('.carousel-item[data-project=\"landing\"]'));
                    } else {
                        setActiveProject('aiva');
                        setActiveCarouselItem(document.querySelector('.carousel-item[data-project=\"aiva\"]'));
                    }
                }, { passive: false });
            }
            
            // Handle clicks on navigation links
            document.body.addEventListener('click', function(e) {
                const link = e.target.closest('a[data-page]');
                const carouselContainer = e.target.closest('.carousel-container');
                const carouselImage = e.target.closest('.carousel-image');
                const projectBackButton = e.target.closest('#project-back-button');
                const projectLeft = e.target.closest('.project-left');
                const themeToggle = e.target.closest('.theme-toggle');
                const overlay = document.getElementById('project-overlay');
                const isOverlayActive = overlay && overlay.classList.contains('active');
                
                // Don't handle theme toggle clicks here - let theme toggle handler work
                if (themeToggle) {
                    return;
                }
                
                // Handle project back button (zoom out)
                if (projectBackButton) {
                    e.preventDefault();
                    e.stopPropagation();
                    zoomOut();
                    return false;
                }
                
                // Handle click anywhere on overlay (zoom out), except links/toggles/back button
                if (isOverlayActive) {
                    const isLink = e.target.closest('a');
                    const zoomedCarousel = e.target.closest('.timeline-carousel.zoomed');
                    if (!isLink && !themeToggle && !projectBackButton) {
                        e.preventDefault();
                        e.stopPropagation();
                        zoomOut();
                        return false;
                    }
                }
                
                // Handle carousel click (zoom in)
                if (carouselContainer || carouselImage) {
                    if (carouselDragMoved) {
                        e.preventDefault();
                        e.stopPropagation();
                        return false;
                    }
                    e.preventDefault();
                    e.stopPropagation();
                    const clickedItem = e.target.closest('.carousel-item') || lastCarouselItem;
                    if (clickedItem) {
                        setActiveCarouselItem(clickedItem);
                        if (clickedItem.dataset && clickedItem.dataset.project) {
                            setActiveProject(clickedItem.dataset.project);
                        }
                    }
                    const carouselEl = document.querySelector('.timeline-carousel');
                    const homePage = document.getElementById('home-page');
                    
                    if (overlay && carouselEl && homePage) {
                        // Reset manual zoom
                        manualZoomLevel = minZoom;
                        maxZoom = activeZoomScale;
                        zoomTargetLeftPx = activeZoomLeftPx;
                        carouselEl.dataset.manualZoom = '0';
                        overlay.classList.add('active');
                        carouselEl.classList.add('zoomed');
                        homePage.classList.add('zoomed');
                        document.body.classList.add('project-active');
                        // Let CSS handle the transform
                        carouselEl.style.transform = '';
                        // Swap to hi-res after zoom completes
                        setTimeout(() => {
                            if (overlay.classList.contains('active')) {
                                swapProjectImages(true);
                            }
                        }, 2200);
                    }
                    return false;
                }
                
                // Handle regular navigation links
                if (link && link.getAttribute('data-page')) {
                    console.log('Link clicked:', link);
                    e.preventDefault();
                    e.stopPropagation();
                    const page = link.getAttribute('data-page') + '-page';
                    console.log('Navigating to page:', page);
                    showPage(page);
                    return false;
                }
                
                // Handle click outside content on About page (go back to home)
                const aboutPage = document.getElementById('about-page');
                const aboutLeft = e.target.closest('.about-left');
                const aboutRight = e.target.closest('.about-right');
                const aboutImage = e.target.closest('.about-image');
                const aboutParagraph = e.target.closest('.about-paragraph');
                const aboutBackButton = e.target.closest('.back-button[data-page="home"]');
                const aboutThemeToggle = e.target.closest('.theme-toggle');
                const aboutLinks = e.target.closest('.about-links');
                const aboutLink = e.target.closest('.about-link, .email-link');
                
                if (aboutPage && aboutPage.classList.contains('active')) {
                    // If click is outside the text field (about-left) and image field (about-right), 
                    // but not on back button or theme toggle, go back to home
                    if (!aboutLeft && !aboutRight && !aboutImage && !aboutParagraph && !aboutBackButton && !aboutThemeToggle && !aboutLinks && !aboutLink) {
                        e.preventDefault();
                        e.stopPropagation();
                        showPage('home-page');
                        return false;
                    }
                }
            });
            
            // Prevent scrolling on home page
            function preventScroll(e) {
                const homePage = document.getElementById('home-page');
                if (homePage && homePage.classList.contains('active')) {
                    e.preventDefault();
                }
            }
            
            document.addEventListener('wheel', preventScroll, { passive: false });
            document.addEventListener('touchmove', preventScroll, { passive: false });
        });
    </script>
</body>
</html>
